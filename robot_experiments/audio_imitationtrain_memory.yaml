# env
env: drq-robosuite
action_repeat: 1 #not used for now
# train
seed: ??
# eval
eval_frequency: 1000
# misc
log_frequency_step: 1000
log_save_tb: true
save_video: true
device: cuda
# observation
image_size: 84
image_pad: 4
horizon: 100 #not used
# global params
lr: 1e-3
system: real

#### mode of operation #####
eval_only: True
checkpoint: 38
load_folder: FrankaKeyQuietMove2_50_30
load_dir: ${load_folder}/11000_CORRECTIONS_2/${checkpoint}_
balanced_batches: false

#things that we can't change without breaking something
lowdim_stack: 10
frame_stack: 3
use_squashed: True #squashed vs not squashed distributions
raw_lowdim: 7
results_root: /iris/u/maxjdu/communal_results/
demos_root: /iris/u/maxjdu/communal_demos/

#####RUN CHANGES HERE ############
#core adjustments
episodeLength: 50
setup_name: FrankaKeyQuietMove2
number_demos: 50
demo_file: ${demos_root}${setup_name}_${number_demos}/demos_finished.pkl
stack: 10 #used to be 10

#audio stuff
audio_steps: ??
audio_bins: ??
audio_shape: ??
audio_feature_dim: 10

#misc training parameters
batch_size: 16
num_train_steps: 25000
expert_workers: 1
correction_workers: 1

#logging
runName: ${load_folder}
# runName: ${setup_name}_${number_demos}_stack1_${seed} # before the seed

##### END CHANGES HERE ##########

# agent configuration
agent:
  name: drq
  class: core.drq_audio_memory.DRQAgent
  params:
    obs_shape: ??? # to be specified later
    action_shape: ??? # to be specified later
    action_range: ??? # to be specified later
    lowdim_dim: ??? #to b e specified later
    device: ${device}
    encoder_cfg: ${encoder}
    critic_cfg: ${critic}
    actor_cfg: ${actor}
    discount: 0.99
    init_temperature: 0.1
    lr: ${lr}
    actor_update_frequency: 2
    critic_tau: 0.01
    critic_target_update_frequency: 2
    batch_size: ${batch_size}
    log_frequency: 20

critic:
  class: core.drq_audio_memory.Critic
  params:
    encoder_cfg: ${agent.params.encoder_cfg}
    action_shape: ${agent.params.action_shape}
    hidden_dim: 1024
    hidden_depth: 2

actor:
  class: core.drq_audio_memory.Actor
  params:
    encoder_cfg: ${agent.params.encoder_cfg}
    action_shape: ${agent.params.action_shape}
    hidden_depth: 2
    hidden_dim: 1024
    log_std_bounds: [-10, 2]

encoder:
  class: core.drq_audio_memory.Encoder
  params:
      obs_shape: ${agent.params.obs_shape}
      feature_dim: 50
      lowdim_dim: ${agent.params.lowdim_dim}
      audio_steps: ${audio_steps}
      audio_bins: ${audio_bins}
      audio_feature_dim: ${audio_feature_dim}
      num_layers: 4
      num_filters: 32
      output_dim: 35
      output_logits: False

#name of the folder directory

log_dir: ${results_root}${runName}
# hydra configuration
hydra:
  name: ${env}
  run:
    dir: ${log_dir}
